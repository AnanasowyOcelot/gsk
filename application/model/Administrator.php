<?phpclass Model_Administrator{	private $db = '';	public $id = 0;	public $grupa_id = '';	public $login = '';	public $imie = '';	public $nazwisko = '';	public $haslo = '';	public $email = '';	public $aktywny = '';	public $grupa_nazwa = '';	public $grupa_aktywna = '';	public $errors = array();	public $uprawnienia = array();	public function __construct($id = 0)	{		$this->db = Core_DB::instancja();		$this->pobierz($id);	}	//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	public function zapisz()	{		$rekord                           = array();		$rekord['administrator_grupa_id'] = $this->grupa_id;		$rekord['administrator_login']    = $this->login;		$rekord['administrator_imie']     = $this->imie;		$rekord['administrator_nazwisko'] = $this->nazwisko;		$rekord['administrator_email']    = $this->email;		$rekord['administrator_aktywny']  = $this->aktywny;		if ($this->haslo != '') {			$rekord['administrator_haslo'] = md5($this->haslo);		}		if ((int)$this->id > 0) {			$rekord["id"] = (int)$this->id;			$insertSQL    = $this->db->AutoExecute('administratorzy', $rekord, 'UPDATE', 'administrator_id = ' . (int)$this->id);		} else {			$insertSQL = $this->db->AutoExecute('administratorzy', $rekord, 'INSERT');			$this->id  = $this->db->Insert_ID();		}	}	//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	public function pobierz($id)	{		$db = Core_DB::instancja();		if ((int)$id > 0) {			$sql = "SELECT				administrator_id AS id,	 			administrator_grupa_id	 AS grupa_id, 	 			administrator_login AS login,	 				 			administrator_imie AS imie,	 			administrator_nazwisko AS nazwisko, 	 			administrator_email AS email,	 			administrator_aktywny AS aktywny,	 			grupa_nazwa AS grupa_nazwa, 	 			grupa_aktywna AS grupa_aktywna, 	 			grupa_id			FROM 				administratorzy ,				administratorzy_grupy			WHERE 				grupa_id=administrator_grupa_id 				AND administrator_id=" . (int)$id;			$rekord = $db->get_row($sql);			$this->fromArray($rekord);			if ((int)$this->grupa_id > 0) {				$this->uprawnienia = Model_Grupa::pobierzUprawnienia($this->grupa_id);			}		}	}	//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	public function get($id_in)	{		//if((int)$id > 0)		$sql = "SELECT				administrator_id AS id,	 			administrator_grupa_id	 AS grupa_id, 	 			administrator_login AS login,	 				 			administrator_imie AS imie,	 			administrator_nazwisko AS nazwisko, 	 			administrator_email AS email,	 			administrator_aktywny AS aktywny,	 			grupa_nazwa AS grupa_nazwa, 	 			grupa_aktywna AS grupa_aktywna, 	 			grupa_id			FROM 				administratorzy ,				administratorzy_grupy			WHERE 				grupa_id=administrator_grupa_id ";		if ((int)$id_in > 0) {			$sql .= ' AND administrator_id=' . (int)$id_in;		}		$rekord = $this->db->get_row($sql);		$this->fromArray($rekord);	}	//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	public function validate()	{		$errors = array();		if (trim($this->login) == "") {			$errors[] = "Podaj login";		}		return $errors;	}	//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	public function fromArray(array $r)	{		$this->id = (int)$r['id'];		if (isset($r['grupa_id'])) {			$this->grupa_id = $r['grupa_id'];		}		if (isset($r['login'])) {			$this->login = $r['login'];		}		if (isset($r['imie'])) {			$this->imie = $r['imie'];		}		if (isset($r['nazwisko'])) {			$this->nazwisko = $r['nazwisko'];		}		if (isset($r['haslo'])) {			$this->haslo = $r['haslo'];		}		if (isset($r['email'])) {			$this->email = $r['email'];		}		if (isset($r['aktywny'])) {			$this->aktywny = $r['aktywny'];		}		if (isset($r['grupa_nazwa'])) {			$this->grupa_nazwa = $r['grupa_nazwa'];		}		if (isset($r['grupa_aktywna'])) {			$this->grupa_aktywna = $r['grupa_aktywna'];		}	}	//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx	public static function czyUprawnienionyDoModulu($administratorId, $modulId)	{		$result = false;		$db     = Core_DB::instancja();		if ((int)$administratorId > 0) {			$o_admin = new Model_Administrator($administratorId);			$sql_uprawnienia    = 'SELECT					au.uprawnienia_stan AS stan				FROM					administratorzy_uprawnienia AS au				WHERE					au.uprawnienia_modul_id = "' . mysql_real_escape_string($modulId) . '"					AND au.uprawnienia_grupa_id = "' . (int)$o_admin->grupa_id . '"					AND au.uprawnienia_grupa_id != 0					AND au.uprawnienia_akcja = "przegladanie"					';			$result_uprawnienia = $db->query($sql_uprawnienia);			$row = $result_uprawnienia->GetArray();			if ($row[0]['stan'] == 1) {				$result = true;			}		}		// TODO: przeniesc gdzies albo usunac		if(in_array($modulId, array('login', 'index'))) {			$result = true;		}		return $result;	}}